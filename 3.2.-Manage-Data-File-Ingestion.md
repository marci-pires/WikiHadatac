_Data/Metadata ingestion_ is the combined process of (Step 1) uploading data/metadata files into the infrastructure's filesystem, and of (Step 2) moving files in the filesystem into the infrastructure's databases.  

Any kind of file can be submitted for ingestion into HADatAc, but only files that meet the following criteria are ingested into HADatAc: 

* files that are associated with existing data streams; and 
* files that are in CSV or Excel formats a (there is a plan for HADatAc to support more data formats in the future). 

## 3.2.1. Manual submission of data file for ingestion

Manual data file upload is done by going to __Home > Manage Data Files__. 

![](https://raw.githubusercontent.com/paulopinheiro1234/hadatac-screenshots/master/Sec3/DatafileManagement.png)

The screenshot above shows the __Manage Data Files__ user interface, showing three distinct areas. 

* drop file area
* processed files folder
* unprocessed files folder

Data files are manually submitted for ingestion by dragging and dropping files into the grey drop file area. Once files are uploaded, they will show up in the unprocessed files folder. For instance, the __DA-CBIS-Feb-2017-DMG-B-3.csv__ in the image above was uploaded into HADatAc, and it is now assigned to a user who can leave the datafile there or may decide to share, download or even delete the file. Once files are uploaded, they are matched against existing streams. 

* If files are __matched against existing streams__, the ingestion of the file starts automatically. 

* If files are __not matched against existing stream__, the association of the file to a stream needs to be done manually, and it may require the creation of a new stream for the file. The manual process of assigning a file to a data stream is described below. 

### 3.2.1.1. Data File Preparation

Data Preparation button next to a newly uploaded DA-* file becomes available when there is no stream available to process the file. In this case, the __Data Preparation__ button should be selected and the form needs to be completed. The following image shows the Data Preparation's online form. 

![](https://raw.githubusercontent.com/paulopinheiro1234/hadatac-screenshots/master/Sec3/DataPreparation.png)  

#### 3.2.1.1.1. Data File's Associated Elements

The Data Preparation Form is a workflow for acquiring metadata required for ingesting the data. For instance, under the current configuration of this specific repository, a data file may be associated with the following:

* A Study associated with the data file of concern. This is often the study that originally funded the effort of acquiring the data which may include the acquisition and deployment of instruments, the execution of simulation models, and the effort of conducting questionnaires with human subjects.  

* Object(s) and/or object collection(s) associated with the values included in the data file of concern.

* An associated deployment describing the instrument and sensors used to acquire the data, as well as the exact conditions in which the instruments where deployed, e.g., associated _standard operating procedure_. 

* An associated Semantic Data Dictionary describing how the contents of the data file are going to be parsed and semantically annotated in terms of attributes and units. 

#### 3.2.1.1.2. Workflow

The process of filling up this form consists of either selecting an existing Stream or identifying all the associated elements. The option of selecting an existing Stream is the first one on the top of the form under "Select Complete and Active Data Acquisition".

If no Stream is suitable for the file to be ingested, then it becomes required to fill out the rest of the form. Selected elements are already shown. Combo box with values are available for existing elements that have not been selected yet. In the screenshot above, we see that the associated object(s)/object collection(s) is the only element that has not been selected yet.

Once associated elements have been identified, the green __Confirm Complete__ button next to the name of the file becomes enabled. By selecting the button, the user confirms that the file is ready for ingestion, which will eventually result in the infrastructure trying to ingest the data file's content.   

#### 3.2.1.1.3. Data Ingestion Error Messages

TBD

## 3.2.2. Automatic submission of data file for ingestion

The process of submitting files for HADatAc ingestion can be accomplished programatically. In this case, all the following need to occur: 

* the code or script responsible for submitting new data files into HADatAc needs to assure have permission to write files into the __unprocessed_csv__ folder of HADatAc    
   * The exact location of __unprocessed_csv__ folder is defined in the autoccsv.config file (as described in [Section 2.1.4](https://github.com/paulopinheiro1234/hadatac/wiki/2.1.-Software-Configuration#214-setting-up-autoccsvconfig))  
* a data stream for the file needs to exits at the time the file is submitted ([Section 3.4.3.](https://github.com/paulopinheiro1234/hadatac/wiki/3.4.3.-Manage-Streams) describes how streams are created)   
* the initial part of name of the file being loaded needs to match the pattern name of the stream (Section describes how the stream's pattern name is specified)


