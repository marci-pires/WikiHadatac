Assuming that HADatAc is installed at "[HADatAc]", configuration files are located at __[HADatAc]/conf__. The way content in __[HADatAc]/conf__ is used is different when using HADatAc in development mode and production mode. 

In production, when an upgrade is doe, it DOES NOT replace the content of __hadatac/conf__ in the distribution because the upgrade should preserve current configuration. To change any configuration file, one needs to change the configuration file in both the current distribution and in "/data/conf" that should not be in "[HADatAc]/conf".  

In development mode, you may just need to update a few files including __hadatac..conf__, and that that change can be done directly in the local copy of what is in the master branch. In case code is contributed back to the master branch, __please do not add and commit changes to [HADatAc]/conf.  

# 2.1.1. Setting up ___hadatac.conf___

This is the main configuration file and tells the system important information about how the webapp connects to SOLR and Blazegraph repositories, and what is going to be the URL of the webapp once it is deployed.

If you are a developer using a local copy of HADatAc in your machine, and you do not have any restriction in calling 'http://localhost:9000' to invoke HADatAc, you may not need to change this part of the configuration. 

If you are deploy HADatAc on a server and you expect users to access HADAtAc over the web, you will need the parameters below accordingly to your domain name and to firewall/port restrictions.
	  
### HADatAc URL Configuration

* the application's base host URL

     default value: __host="http://localhost:9000"__
		
* the url that the application is deployed

     default value: __host_deploy="http://localhost:9000"__
		
* the base url that the application uses to send email and receive email. This is the value prefixed to HADatAc services used to communicate with users during email authentication or password reset. Emails may be sent out if this value is not set properly, but the confirmation of any action embedded in email messages may not have any effect on HADatAc.

     default value: __base_url="127.0.0.1:9000"__
		
* the kb's base host URL -- usually, the application's base host URL without any port information. This value is used to build absolute URLs from internal relative URLS, and it is used to inter-connect HADatAc functionalities including the URLs of internal proxies used by javascript code.  

     default value: __kb="http://localhost"__

### SOLR Configuration
    
* HOME: the path in the file system where the SOLR instances are located

     default: home=/../hadatac/solr

* URL for data collections

     default: data="http://127.0.0.1:8983/solr"

### Blazegraph Configuration
        
* URL used to retrieve content from a Blazegraph repository.  

  * For blazegraph in the local

    default: triplestore="http://127.0.0.1:9999/blazegraph/namespace/store"

  * For blazegraph in the vm

    default: triplestore="http://127.0.0.1:8080/bigdata/namespace"
	    
  * URL for user management collection

    default: users="http://127.0.0.1:8983/solr"

  * URL for user permission management collection

    * For blazegraph in the local

    default: permissions="http://127.0.0.1:9999/blazegraph/namespace/store_users"

    * For blazegraph in the vm
    default: permissions="http://127.0.0.1:8080/bigdata/namespace"

* activity flags are used to verify if HADatAc knowledge base contains 

  * concepts essential for supported scientific activities 

  * use true for empirical activities involving the use of sensors

     empirical=true

  * use true for computational activities involving computational simulations

     computational=false

* properties about community using current HADatAc installation

  * these properties are used to project customization of HADaAc installations
       
    default: fullname="Child Health Exposure Analysis Repository"
       
    default: shortname="CHEAR"
       
    default: description=""
	   
    default: ont_prefix="heals"

# 2.1.2. Setting up email configuration

You may not need to set up email configuration if you are using HADatAc for development purpose. This configuration is essential if you are planning to create users with authenticated access to the system. In this case, the email configuration will enable users to verify their emails and to request password reset.

Authentication is done through email verification, which requires HADatAc to communicate with users through emails. The configuration file is __smtp.conf__ under __/conf/play_authenticate__. Instructions for filling up the configuration file are described inside of the file itself. The email account to be used should be one created used for your system (not the gmail account shown in the example below).

    play.mailer {
        # TODO: Disable this in production
        mock=false
        # SMTP server
        # (mandatory)
        # defaults to gmail
        host=smtp.gmail.com

        # SMTP port
        # defaults to 25
        port=465

        # Use SSL
        # for GMail, this should be set to true
        ssl=true

        # authentication user
        # Optional, comment this line if no auth
        # defaults to no auth
        user="hadatac1234@gmail.com"

        # authentication password
        # Optional, comment this line to leave password blank
        # defaults to no password
        password="password"
    }

# 2.1.3. Setting up ___application.conf___

* Deadbolt

     required value: __"play-authenticate/deadbolt.conf"__

* SMTP

     required value: __"play-authenticate/smtp.conf"__

* Play authenticate

     required value: __"play-authenticate/mine.conf"__

* HADatAc 

     required value: __"hadatac.conf"__

* Session conf

     session.maxAge=1h
     play.http.session.maxAge=12h

* java config

     jvm.memory=-Xmx2048M -Xms2048M

# 2.1.4. Setting up ___autoccsv.config___

Raw files and metadata files that are uploaded into HADatAc are managed as part of the overall content of the app. This configuration file tells the app where those files go when are initially uploaded and where they are stored after they are processed.

* Configure the path of csv files
 path_proc=processed_csv/
 path_unproc=unprocessed_csv/
 auto=on

# 2.1.5. Setting up ___namespaces.properties___

This configuration file has a list of all the namespaces used in HADatAc's knowledge base. __This list is cached inside of HADatAc when it is running, and HADatAc needs to be restarted for any change to this configuration file to take effect__. 

This list has two purposed:
* to indicate which ontologies should be loaded into HADatAc's knowledge graph
* to indicate which namespaces may be used as a prefix during the execution of any SPARQL query against the repository

Every loaded ontology should be included in the list of SPARQL prefixes, but the content inside the knowledge graph may refer to terms from namespaces that are not necessarily loaded into the knowledge graph.

Each namespace has four attributes:

* __definition (mandatory)__: It is of the form [abbreviation]=[reference_URI] like __xsd=http://www.w3.org/2001/XMLSchema#__ where [abbreviation] is __xsd__ and [reference_URI] is  __http://www.w3.org/2001/XMLSchema#__
* __mime type (only for loaded ontologies)__: this attribute identifies the encoding format of the ontology to be loaded. If the ontology is encode in RDF/XML the value for this attribute should be __application/rdf+xml__. If the ontology is encode in turtle tha value for this attribute should be __text/turtle__. 
* __loading URL (only for loaded ontologies)__: this is an URL that should be resolvable on the web (it is suggested that  the URL is tested in a browser to verify if the URL is resolvable). 

# 2.1.6. Setting up ___labkey.config___

* Configure the labkey server url

 site=https://chear.tw.rpi.edu/labkey/
 folder=CHEAR PRODUCTION

* Configure the key for encryption on LabKey authority

 encryption_key=yourkey

# 2.1.7. Setting up ___template.conf___

This file is used to define the name of the column headers of all the template files used in HADatAc: STD, SSD, PID, SID, MAP, ACQ, OAS, SDD. Each one of these template files is composed off a fixed, ordered list of properties, and the column header of each one of these templates must be a column header defined in the vocabulary of this configuration file.

# 2.1.8. Creating Master User

Each HADatAc installation has one Master user. This used can only be created once, and the password used to create this user needs to be carefully noted.

**Why the Master User is Unique**  
The Master user is unique because of the following:  
- every functional HADatAc installation has one Master User  
- it can only be created once  
- it is already created as a verified user without the need of email configuration (and without the need of setting up an emailer to work with HADatAc  
- it is already created with admin permission
In summary, the Master User is everything needed for ONE USER to start using all the functionalities in HADatAc. That is a very important feature for rapid installation of development copies of HADatAc.

**How to Create a Master User**  
The user is created by selecting the "Sign Up" option in HADatAc's main page. The process is the same as the sign up of any other user. The only difference is that once the Master user is created, it is already available to log in. If a Master User is created, there is no way to create a new Master User, and any use of the Sign Up button will only be allowed to users who have already be pre-registered (see Section 5.2).  

**How to Reset the Password for the Master User**  
This option consists of erasing the following:

- In Blazegraph: the content of the store_users. One easy way of erasing the content from store_users' namespace in Blazegraph is of erasing the namespace itself and creating in again.
- In Solr, the content of the following tables under solr/solr-home: __users__, __linked_account__, and __token_action__. Each table in Solr is composed of two folders and one file: __conf__, __data__ and __core.properties__. The content of the table is inside the __data__ folder. In this case, it is possible to erase the __data__ folder that is going to be recreated the next time you start Solr. Another option is to replace the entire solr/solr_home folder with its content from github.
